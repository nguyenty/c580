\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage[margin=0.5in]{geometry}
\usepackage{boxedminipage}
\usepackage{amsfonts}
\usepackage{amsmath} 
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{amsthm}
\usepackage{t1enc}
\usepackage{subfig}
\usepackage{hyperref}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}
\title{\color{red}HW3 - STAT 580 - Sp 2015}
\author{Yet T Nguyen}
\date{02/26/2015}
\maketitle

\section*{1.}
\begin{itemize}
\item [(a)] 
\begin{align*}
P(U \leq r(X)) & = \int_\mathbb{X} \left(\int_0^{r(x)} du\right) g(x) dx\\
               & = \int_\mathbb{X} r(x)g(x)dx\\
               & = \int_\mathbb{X}\frac{q(x)}{\alpha g(x)}g(x) dx \\
               & = \frac{1}{\alpha}\int_\mathbb{X}q(x)dx.
\end{align*}


\item [(b)] 
\begin{align*}
P(X\in A, U \leq r(X)) & = \int_{A} \left(\int_0^{r(x)} du\right) g(x) dx\\
               & = \int_{A} r(x)g(x)dx\\
               & = \int_{A}\frac{q(x)}{\alpha g(x)}g(x) dx \\
               & = \frac{1}{\alpha}\int_{A}q(x)dx.
\end{align*}

Therefore, 

\begin{align*}
P(Y\in  A) &= P(X\in A|U\leq r(X)) \\
           &= \frac{P(X\in A, U \leq r(X))}{P(U \leq r(X))}\\
           &=\frac{\frac{1}{\alpha}\int_{A}q(x)dx}{\frac{1}{\alpha}\int_\mathbb{X}q(x)dx}\\
           &=\frac{\frac{1}{\alpha}\int_{A}cq(x)dx}{\frac{1}{\alpha}\int_\mathbb{X}cq(x)dx}\\ 
           &=\frac{\frac{1}{\alpha}\int_{A}f(x)dx}{\frac{1}{\alpha}\int_\mathbb{X}f(x)dx}\\ 
           &=\int_A f(x)dx \quad (\mbox{since } \int_\mathbb{X}f(x)dx = 1)
\end{align*}
\end{itemize}
\section*{2.}
\begin{itemize}
\item[(a)] Let $g(x) = c(2x^{\theta -1} e^{-x} + x^{\theta - 1/2} e^{-x})$. Then 
\begin{align}
g(x) & = c\left(2\Gamma(\theta) frac{1}{\Gamma(\theta)}e^{\theta - 1} e^{-x} + \Gamma(\theta + 1/2) \frac{1}{\Gamma(\theta + 1/2)} e^{\theta -1/2}e^{-x}  \right)\notag\\
     & = c(2\Gamma(\theta) \mbox{Gamma}(\theta, 1) + \Gamma(\theta +1/2) \mbox{Gamma}(\theta +1/2, 1)). \label{eq1}
\end{align} 
Since $\int  g dx = 1$, hence 
\begin{equation}\label{eq2}
c = \frac{1}{2\Gamma(\theta) + \Gamma(\theta + 1/2)}.
\end{equation}
\item[(b)] and from \eqref{eq1}, $g$ is the mixture of 2 Gamma distribution  $\mbox{Gamma}(\theta, 1)$ and $\mbox{Gamma}(\theta +1/2, 1)$ with the corresponding weights 

\[
\frac{2\Gamma(\theta)}{2\Gamma(\theta) + \Gamma(\theta + 1/2)}, \quad \frac{\Gamma(\theta+1/2)}{2\Gamma(\theta) + \Gamma(\theta + 1/2)}
\]

\item[(c)] A procedure to sample from $g(x)$: 
\begin{itemize}
\item[1.] Generate $U \sim \mbox{Unif}(0,1), X_1 \sim \mbox{Gamma}(\theta, 1), X_2 \sim \mbox{Gamma}(\theta+1/2, 1)$ independently, where a procedure to sample from any $\mbox{Gamma}(., 1)$ distribution can be conducted using a rejection sampling procedure following from Theorem 3.3 (page 29 in the link and page 406 in the  book) \href{http://www.nrbook.com/devroye/Devroye_files/chapter_nine.pdf}{http://www.nrbook.com/devroye/Devroye\_files/chapter\_nine.pdf}    
\item[2.] If $U \leq \frac{2\Gamma(\theta)}{2\Gamma(\theta) + \Gamma(\theta + 1/2)}$ then $X = X_1$, otherwise, $X = X_2$
\item[3.]  The random variable $X$ has distribution $g(x)$.
\end{itemize}

\item [(d)] Sampling a random variable having distribution $f$ using $g$ as proposed distribution. 
It is easy to see 
\[
\sqrt{4+ x} \leq 2 + x^{1/2},
\]
hence
\begin{equation}\label{eq3}
q(x) \equiv \sqrt{4+x} x^{\theta -1} e^{-x} \leq (2+ x^{1/2}) x^{\theta-1} e^{-x }
\leq \frac{1}{c} g(x),
\end{equation}
where $c$ is defined as in \eqref{eq2}.
\begin{itemize}
\item[1.] Generate $X \sim g(x)$ as in part $(c)$, and generate $U \sim \mbox{Unif}(0,1)$ independently. Set $r(x) = \frac{c q(x)}{g(x)}$, where $q$ is defined as in \eqref{eq3}. 
\item[2.] If $U \leq r(X)$, then accept $X$, otherwise, repeat step 1.
\end{itemize} 
\end{itemize}

\section*{3.}
\begin{verbatim}
#include <stdio.h>
#define N  16 /* number of observations */
#define P  2 /* number of predictors */

void dgesv_(int *NN, int *NRHS, double *A, int *LDA, int *IPIV,
            double *B, int *LDB, int *INFO);
int main(){
  /* longley dataset from R: Employed (Y) GNP.deflator and Population (X) */
    double Y[N] = {60.323,61.122,60.171,61.187,63.221,63.639,64.989,
                   63.761,66.019,67.857,68.169,66.513,68.655,69.564,
                   69.331,70.551};
double X[N][P] =
{{83,107.608},
{88.5,108.632},
{88.2,109.773},
{89.5,110.929},
{96.2,112.075},
{98.1,113.27},
{99,115.094},
{100,116.219},
{101.2,117.388},
{104.6,118.734},
{108.4,120.445},
{110.8,121.95},
{112.6,123.366},
{114.2,125.368},
{115.7,127.852},
{116.9,130.081}};

double XtX[(P+1)*(P+1)]; 
double XtY[P+1];

int ipiv[P+1];
int i, j, k, n1, n2, info;
/* Calculate (1, X)'*(1, X) which is a 3X3 matrix*/
XtX[0] = N;

for(i = 1;i<P+1;i++){
  XtX[i*(P+1) + 0] = 0;
  for(j=0;j<N;j++)
  XtX[i*(P+1) + 0] += X[j][i-1];
  XtX[0*(P+1)+i] = XtX[i*(P+1) + 0];
}

for(i=1;i<P+1;i++){
  for(j=1;j<P+1;j++){
    XtX[i*(P+1)+j] = 0;
    for(k=0;k<N;k++){
      XtX[i*(P+1)+j]+=X[k][i-1]*X[k][j-1];
    }
  }
}

/* Calculate (1,X)'*Y which is a 3x1 matrix*/
XtY[0] = 0;
for(i=0;i<N;i++)
XtY[0] +=Y[i];

for(i=1;i<P+1;i++){
  XtY[i] = 0;
  for(j=0;j<N;j++)
  XtY[i] +=X[j][i-1]*Y[j];
}
n1 = P+1;
n2 = 1;
dgesv_(&n1, &n2, XtX, &n1, ipiv, XtY, &n1, &info);

if (info != 0)
printf("dgesv error %d\n", info);
for (i=0; i<P+1; i++)
printf("%f\t", XtY[i]);
printf("\n");
return 0;
}
/* gcc -pedantic -Wall -ansi  hw33.c -llapack -lblas -lgfortran */
/* 26.851352  0.240842  0.119026*/
\end{verbatim}
\end{document}
